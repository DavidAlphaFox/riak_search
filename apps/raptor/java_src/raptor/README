Raptor Indexing Engine
======================

Requirements
------------
Java 1.6.x
Ant
gcc toolchain
BDB 4.8.30

Installation
------------

Note: if you are installing for use on Mac OS X, see the section "Compiling for Mac OS X" below.

1. Download BDB 4.8.30 from: http://download.oracle.com/berkeley-db/db-4.8.30.NC.tar.gz
2. Build and install:

cd db-4.8.30.NC
cd build_unix
../dist/configure --enable-java
make
sudo make install

3. Enter the raptor directory and run:

ant clean
ant

Running
-------

You can use ./start.sh to start from the command line.

Useful Information
------------------

1. You can edit log4j.properties to change the logging characteristics
2. From the riak search console you can significantly decrease logging output (though not turn it off entirely) by using the command:

raptor_index_backend:poke("toggle_debug").

3. If you want to delete the data stored in Raptor, delete the directories "raptor-db" and "raptor-catalog".

Compiling for Mac OS X
----------------------

To run Raptor on Mac OS X, you must first build a 64-bit version of BDB.  Run the following commands before any of the installation steps above:

export CC=gcc
export CFLAGS="-arch x86_64 -m64"
export CXXFLAGS="-arch x86_64 -m64"
export LDFLAGS="-arch x86_64 -m64"

If you have already installed it as 32-bit, type "make realclean" in the build_unix directory and start the configuration and installation process again.

Notes
-----

1. MMap and Cache memory use for both BDB and Lucene are currently hard coded while a good configuration system is being worked on.  In the meantime it is recommended you run Raptor on server with a MINIMUM of 2G ram.
2. You may use Raptor on 32-bit systems; change the command line option in start.sh from "-d64" to "-d32"
3. 32-bit operation is not available on Mac OS X systems (Java 1.6 has no 32 bit mode on OS X)
4. If you wish to keep the BDB native library in somewhere other than it's installed location, change the following command line option in start.sh to reflect the new location:

-Djava.library.path=/usr/local/lib:java.library.path=/usr/local/lib:/usr/local/BerkeleyDB.4.8/lib

5. By default, start.sh reserves 4G of memory for execution.  You may change this by editing this command line option in start.sh:

-Xmx4096m

6. Raptor has only been tested on Mac OS X and Linux.


